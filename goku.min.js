!function(t){"use strict";function e(t){if(!t)return!0;for(var e in t)if(t.hasOwnProperty(e))return!1;return!0}function i(){return"goku-"+a++}function s(t){if(!t)throw new Error("Goku: no argument");if("string"==typeof t&&(t=document.querySelector(t)),!t)throw new Error("Goku: no element found");if(r[t.dataset.gokuId])return r[t.dataset.gokuId];var s=i();return t.dataset.gokuId=s,r[s]=new Transition(t,{id:s,onstart:function(){o||(console.log("goku.js: start animation loop"),o=u(n))},oncomplete:function(t){var i=t.dataset.gokuId;delete t.dataset.gokuId,delete r[i],e(r)&&(console.log("goku.js: complete animation loop"),h(o),o=null)}}),r[s]}function n(t){o=u(n);for(var e in r)r[e].step&&r[e].step(t)}var o,r={},a=0,u=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(t){return window.setTimeout(t,1e3/60)},h=window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||function(t){window.clearTimeout(t)};t.goku=s}(window),function(t){"use strict";function e(t,e){e=e||{},this.element=t,this.id=e.id,this.onstart=e.onstart,this.oncomplete=function(){this._clear(),e.oncomplete(this.element)}.bind(this),this.queue=[],this.timings=[],this.playingIndex=-1,this.elapsedTime=0,this.lastTimestamp=0,this.isPaused=!1,this.pausingIndex=-1,this.promiseQueue=[],this.animate=this.animate.bind(this),this.delay=this.delay.bind(this),this.pause=this.pause.bind(this)}var i=400,s="ease",n=4;e.prototype={_generatePromiseTask:function(){var t={},e=new Promise(function(e,i){t.resolve=e,t.reject=i});return e.animate=this.animate,e.delay=this.delay,e.pause=this.pause,t.promise=e,t},_generateTransform:function(t,e){var i=getComputedStyle(t).transform;t.style.transform="none"===i?e:i+" "+e},_generateTransformByMatrix:function(){},addClass:function(){},animate:function(){var t=Array.prototype.slice.call(arguments);if(!t[0])throw new Error("Goku: missing arguments!");if("string"==typeof t[0])throw new Error("Goku: implement this!");if("object"==typeof t[0]){var e=t[0],n=t[1]||{},o=[];for(var r in e)o.push(r);var a=o.join(" ");n.duration=n.duration||i,this.timings.push(n.duration);var u=this,h={properties:e,options:n,start:function(){u.element.style.transitionProperty=a,u.element.style.transitionDuration=n.duration+"ms",u.element.style.transitionTimingFunction=n.easing||s,u.element.offsetWidth;for(var t in e)u.element.style[t]="transform"===t?e[t]:e[t];n.start&&n.start()}};this.queue.push(h),1===this.queue.length&&this.onstart();var l=this._generatePromiseTask();return this.promiseQueue.push(l),l.promise}},delay:function(t){if(console.log(this.id,"delay"),!(t>0))throw new Error("Goku: missing arguments!");this.queue.push({}),this.timings.push(t),1===this.queue.length&&this.onstart();var e=this._generatePromiseTask();return this.promiseQueue.push(e),e.promise},pause:function(){return console.log(this.id,"pause"),this.isPaused=!0,this},play:function(){return console.log(this.id,"play"),this.isPaused=!1,this.promiseQueue[this.playingIndex].promise},reset:function(){},reverse:function(){},speed:function(t,e){console.log(this.id,"speed");var i=this.queue[this.playingIndex];if(i){t=t||n;var s,o=i.properties,r=(i.options.duration-this.elapsedTime)/t,a=getComputedStyle(this.element);for(s in o)this.element.style[s]=a[s];this.element.offsetWidth;for(s in o)this.element.style[s]=o[s];if(this.element.style.transitionDuration=r+"ms",this.timings[this.playingIndex]=r,this.elapsedTime=0,this.lastTimestamp=0,e)for(var u=this.playingIndex+1;u<this.queue.length;u++)this.queue[u].options.duration/=t,this.timings[u]/=t;return this}},stop:function(){return console.log(this.id,"stop"),this._goto(this.playingIndex),this._next(),this},_goto:function(t){if(!this.queue[t]||!this.queue[t].properties)return!1;var e=this.queue[t].properties;this.element.style.transitionProperty="none";for(var i in e)this.element.style[i]=e[i];return this.element.offsetWidth,!0},finish:function(){console.log(this.id,"finish");for(var t=this.queue.length-1;!this._goto(t)&&t>-1;)t-=1;var e=this.promiseQueue;return this.oncomplete(),e.forEach(function(t){t.resolve()}),this},step:function(t){if(!this.isPaused&&this.lastTimestamp&&(this.elapsedTime+=t-this.lastTimestamp),this.lastTimestamp=t,-1===this.playingIndex)return void this._next();if(!(this.isPaused&&this.pausingIndex>-1)){var e,i,s;if(this.isPaused&&this.pausingIndex<0){this.pausingIndex=this.playingIndex;var n=getComputedStyle(this.element);e=this.queue[this.playingIndex],i=e.properties;for(s in i)this.element.style[s]=n[s]}else if(!this.isPaused&&this.pausingIndex>-1){this.pausingIndex=-1,e=this.queue[this.playingIndex],i=e.properties;for(s in i)this.element.style[s]=i[s]}else if(this.elapsedTime>this.timings[this.playingIndex]){e=this.queue[this.playingIndex],e.options&&"function"==typeof e.options.complete&&e.options.complete();var o=this.promiseQueue[this.playingIndex];o.resolve(),this._next()}}},_next:function(){if(this.playingIndex+=1,this.queue[this.playingIndex]){console.log(this.id,"next");var t=this.queue[this.playingIndex];t.options&&"function"==typeof t.options.before&&t.options.before(),t.start&&"function"==typeof t.start&&t.start(),this.elapsedTime=0,this.lastTimestamp=0}else console.log(this.id,"end"),this.oncomplete()},_clear:function(){console.log(this.id,"clear"),this.playingIndex=-1,this.queue.length=0,this.timings.length=0,this.elapsedTime=0,this.lastTimestamp=0,this.isPaused=!1,this.pausingIndex=-1,this.promiseQueue=[]}},t.Transition=e}(window);
//# sourceMappingURL=maps/goku.min.js.map