!function(t){"use strict";function i(){return"goku-"+a++}function e(t){if(!t)throw new Error("Goku: no argument");if("string"==typeof t&&(t=document.querySelector(t)),!t)throw new Error("Goku: no element found");if(o[t.dataset.gokuId])return o[t.dataset.gokuId];var e=i();return t.dataset.gokuId=e,o[e]=new Transition(t,{id:e,onstart:function(t){r.indexOf(t)<0&&r.push(t),n||(console.log("goku.js: start animation loop"),n=h(s))},oncomplete:function(t){var i=t.dataset.gokuId;r.indexOf(i)>-1&&r.splice(r.indexOf(i),1),r.length<1&&(console.log("goku.js: complete animation loop"),u(n),n=null)}}),o[e]}function s(t){n=h(s),r.forEach(function(i){o[i].step&&o[i].step(t)})}var n,o={},r=[],a=0,h=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(t){return window.setTimeout(t,1e3/60)},u=window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||function(t){window.clearTimeout(t)};t.goku=e}(window),function(t){"use strict";function i(t,i){i=i||{},this.element=t,this.id=i.id,this.onstart=i.onstart,this.oncomplete=function(){this.isStarted=!1,this._reset(),i.oncomplete(this.element)}.bind(this);var e=this.element.style.cssText;this.defaultStyle=e,this.queue=[],this.originalTimings=[],this.timings=[],this.playingIndex=-1,this.elapsedTime=0,this.lastTimestamp=0,this.isStarted=!1,this.isPaused=!1,this.isPauseHandled=!1,this.promiseQueue=[],this.animate=this.animate.bind(this),this.delay=this.delay.bind(this),this.pause=this.pause.bind(this)}var e=400,s="ease",n=4;i.prototype={_generatePromiseTask:function(){var t={},i=new Promise(function(i,e){t.resolve=i,t.reject=e});return i.animate=this.animate,i.delay=this.delay,i.pause=this.pause,t.promise=i,t},_generateTransform:function(t,i){var e=getComputedStyle(t).transform;t.style.transform="none"===e?i:e+" "+i},_generateTransformByMatrix:function(){},addClass:function(){},animate:function(){var t=Array.prototype.slice.call(arguments);if(!t[0])throw new Error("Goku: missing arguments!");if("string"==typeof t[0])throw new Error("Goku: implement this!");if("object"==typeof t[0]){var i=t[0],n=t[1]||{},o=[];for(var r in i)o.push(r);var a=o.join(" ");n.duration=n.duration||e,this.originalTimings.push(n.duration),this.timings.push(n.duration);var h=this,u={properties:i,options:n,start:function(){h.element.style.transitionProperty=a,h.element.style.transitionDuration=n.duration+"ms",h.element.style.transitionTimingFunction=n.easing||s,h.element.offsetWidth;for(var t in i)h.element.style[t]=i[t];n.start&&n.start()}};this.queue.push(u),this.onstart(this.id);var l=this._generatePromiseTask();return this.promiseQueue.push(l),l.promise}},delay:function(t){if(!(t>0))throw new Error("Goku: missing arguments!");this.queue.push({}),this.originalTimings.push(t),this.timings.push(t),this.onstart(this.id);var i=this._generatePromiseTask();return this.promiseQueue.push(i),i.promise},pause:function(){return this.isStarted&&(this.isPaused=!0),this},play:function(){return this.isPaused=!1,this.promiseQueue[this.playingIndex].promise},reset:function(){return this.element.style.cssText=this.defaultStyle,this.playingIndex=-1,this.element.offsetWidth,this.oncomplete(),this},reverse:function(){},speed:function(t,i){var e=this.queue[this.playingIndex];if(e){t=t||n;var s,o=e.properties,r=(e.options.duration-this.elapsedTime)/t,a=getComputedStyle(this.element);for(s in o)this.element.style[s]=a[s];this.element.offsetWidth;for(s in o)this.element.style[s]=o[s];if(this.element.style.transitionDuration=r+"ms",this.timings[this.playingIndex]=r,this.elapsedTime=0,this.lastTimestamp=0,i)for(var h=0,u=this.playingIndex+1;u<this.queue.length;u++)h=this.originalTimings[u]/t,this.queue[u].options.duration=h,this.timings[u]=h;return this}},stop:function(){return this.isStarted&&(this._goto(this.playingIndex),this._next()),this},_goto:function(t){if(!this.queue[t]||!this.queue[t].properties)return!1;var i=this.queue[t].properties;this.element.style.transitionProperty="none";for(var e in i)this.element.style[e]=i[e];return this.element.offsetWidth,!0},finish:function(){if(this.queue.length<1)return this;for(var t=this.queue.length-1;!this._goto(t)&&t>-1;)t-=1;var i=this.promiseQueue;return this.playingIndex=this.queue.length-1,this.oncomplete(),i.forEach(function(t){t.resolve()}),this},step:function(t){if(!this.isPaused&&this.lastTimestamp&&(this.elapsedTime+=t-this.lastTimestamp),this.lastTimestamp=t,!this.isStarted)return this.isStarted=!0,void this._next();if(!this.isPaused||!this.isPauseHandled){var i,e,s;if(!this.isPaused||this.isPauseHandled)if(this.isPaused||!this.isPauseHandled){if(this.elapsedTime>this.timings[this.playingIndex]){i=this.queue[this.playingIndex],i.options&&"function"==typeof i.options.complete&&i.options.complete();var n=this.promiseQueue[this.playingIndex];n.resolve(),this._next()}}else{this.isPauseHandled=!1,i=this.queue[this.playingIndex],e=i.properties;for(s in e)this.element.style[s]=e[s]}else{this.isPauseHandled=!0;var o=getComputedStyle(this.element);i=this.queue[this.playingIndex],e=i.properties;for(s in e)this.element.style[s]=o[s]}}},_next:function(){if(this.playingIndex+=1,this.queue[this.playingIndex]){var t=this.queue[this.playingIndex];t.options&&"function"==typeof t.options.before&&t.options.before(),t.start&&"function"==typeof t.start&&t.start()}else console.log(this.id,"end"),this.playingIndex-=1,this.oncomplete();this.elapsedTime=0,this.lastTimestamp=0},_reset:function(){for(var t=0;t<this.queue.length;t++)this.queue[t].options.duration=this.originalTimings[t],this.timings[t]=this.originalTimings[t]},_clear:function(){this.playingIndex=-1,this.queue.length=0,this.originalTimings.length=0,this.timings.length=0,this.elapsedTime=0,this.lastTimestamp=0,this.isStarted=!1,this.isPaused=!1,this.isPauseHandled=!1,this.promiseQueue=[]}},t.Transition=i}(window);
//# sourceMappingURL=maps/goku.min.js.map